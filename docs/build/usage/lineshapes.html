
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lineshapes &#8212; peakipy 0.1.16 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Code" href="code.html" />
    <link rel="prev" title="Examples" href="examples.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="lineshapes">
<h1>Lineshapes<a class="headerlink" href="#lineshapes" title="Permalink to this headline">¶</a></h1>
<p>Here are the lineshapes used by peakipy. To select a specific lineshape to fit you can add <code class="docutils literal notranslate"><span class="pre">--lineshape=</span></code> flag when running <code class="docutils literal notranslate"><span class="pre">peakipy</span> <span class="pre">fit</span></code>.</p>
<p>For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peakipy</span> <span class="n">fit</span> <span class="n">test</span><span class="o">.</span><span class="n">csv</span> <span class="n">test1</span><span class="o">.</span><span class="n">ft2</span> <span class="n">fits</span><span class="o">.</span><span class="n">csv</span> <span class="o">--</span><span class="n">lineshape</span><span class="o">=</span><span class="n">G</span>
</pre></div>
</div>
<p>Would fit to a Gaussian lineshape in both dimensions. Other options are V, L or PV for Voigt Lorentzian or Pseudo-Voigt in both dimensions, respectively.
If you want to fit a seperate lineshape for the indirect dimension then PV_PV allows you to fit a Pseudo-Voigt with seperate X and Y fraction parameters</p>
<div class="section" id="gaussian">
<h2>Gaussian<a class="headerlink" href="#gaussian" title="Permalink to this headline">¶</a></h2>
<p><span class="math notranslate nohighlight">\(\frac{1}{\sigma_g\sqrt{2\pi}}\exp \frac{-(x - center)^2 } { 2 \sigma_g^2}\)</span></p>
</div>
<div class="section" id="lorentzian">
<h2>Lorentzian<a class="headerlink" href="#lorentzian" title="Permalink to this headline">¶</a></h2>
<p><span class="math notranslate nohighlight">\(\frac{1}{\pi} \left( \frac{\sigma}{(x - center)^2 + \sigma^2}\right)\)</span></p>
</div>
<div class="section" id="pseudo-voigt">
<h2>Pseudo-Voigt<a class="headerlink" href="#pseudo-voigt" title="Permalink to this headline">¶</a></h2>
<p><span class="math notranslate nohighlight">\(\frac{(1-fraction)}{\sigma_g\sqrt{2\pi}}\exp \frac{-(x - center)^2 }{ 2 \sigma_g^2} + \frac{fraction}{\pi} \left( \frac{\sigma}{(x - center)^2 + \sigma^2}\right)\)</span></p>
<p>This is the default lineshape used for fitting and the fraction of G or L is assumed to be the same for both dimensions. The <code class="docutils literal notranslate"><span class="pre">--lineshape=PV_PV</span></code> option will fit a seperate pseudo-voigt lineshape in each dimension (i.e. fraction_x and fraction_y parameters).</p>
</div>
<div class="section" id="fit-quality">
<h2>Fit quality<a class="headerlink" href="#fit-quality" title="Permalink to this headline">¶</a></h2>
<p>Fit quality can be evaluated by inspecting the contour plot of residuals that is generated when viewing fits interactively. <span class="math notranslate nohighlight">\(\chi^2\)</span> and <span class="math notranslate nohighlight">\(\chi_{red}^2\)</span> are calculated using the noise estimate from <code class="docutils literal notranslate"><span class="pre">--noise</span></code> or the threshold value calculated from <code class="docutils literal notranslate"><span class="pre">threshold_otsu</span></code> if <code class="docutils literal notranslate"><span class="pre">--noise</span></code> is not set explicitly.
Peakipy does calculate the linear correlation between the NMR data and the simulated data from the fit. If the slope deviates by more than 0.05 from 1.0 then it is advised that you check the fit. However, this is not totally robust and it is best to check fit quality by plotting the data using the <code class="docutils literal notranslate"><span class="pre">peakipy</span> <span class="pre">check</span></code> script.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=j-brady&repo=peakipy&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">How to install peakipy</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="instructions.html">Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Lineshapes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#gaussian">Gaussian</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lorentzian">Lorentzian</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pseudo-voigt">Pseudo-Voigt</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fit-quality">Fit quality</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code.html">Code</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="examples.html" title="previous chapter">Examples</a></li>
      <li>Next: <a href="code.html" title="next chapter">Code</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Jacob Peter Brady.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/usage/lineshapes.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>